# 项目简化说明

## 修改目的

根据新的需求，简化项目结构，删除复杂的图片处理功能。

## 主要修改

### 1. 简化目录结构

**之前的结构**：
```
data/
├── excel_files/     # Excel文件存储目录
│   ├── 文件1.xlsx
│   └── temp.xlsx
└── pictures/        # 图片存储目录
    └── 单位名称/
         └── 图片文件
```

**现在的结构**：
```
data/
├── 文件1.xlsx
├── 文件2.xlsx
├── temp.xlsx        # 临时文件（自动生成）
└── backups/        # 备份文件目录
    └── 文件1.xlsx.bak
```

### 2. 代码修改

#### backend/excel_service.py

**删除的内容**：
- ❌ `from openpyxl import load_workbook`
- ❌ `from openpyxl.drawing.image import Image as XLImage`
- ❌ `_insert_images()` 方法（图片插入功能）
- ❌ 保存时调用 `self._insert_images(file_name)`

**修改的内容**：
- ✅ 默认目录从 `data/excel_files` 改为 `data`
- ✅ 备份目录从 `data/excel_files/backups` 改为 `data/backups`

#### backend/main.py

**修改的内容**：
- ✅ 目录创建逻辑简化，只创建 `data/` 和 `data/backups/`

### 3. 数据模型变化

**项目图片字段**：
- 之前：需要处理图片路径、插入图片到Excel
- 现在：只是留空，不做任何处理

## 测试结果

✅ 所有功能正常：
- ✅ 文件列表获取：正常
- ✅ Excel数据读取：正常
- ✅ 数据保存：正常
- ✅ 撤回功能：正常
- ✅ 数据验证：正常

## 优势

1. **更简洁**：不需要处理图片的复杂逻辑
2. **更快速**：减少了文件操作和图片处理
3. **更稳定**：减少了可能的错误点
4. **更易维护**：代码更简单，更容易理解和维护

## 使用方式

启动后端服务：
```bash
python backend/main.py
```

Excel文件直接放在 `data/` 目录下即可。

## 注意事项

1. 项目图片字段现在只是留空，不做任何处理
2. Excel文件直接放在 `data/` 目录下
3. 备份文件自动保存在 `data/backups/` 目录下
4. 临时文件 `temp.xlsx` 用于安全写入
